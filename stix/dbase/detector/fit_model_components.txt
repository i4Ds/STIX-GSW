;+
; fit_model_components.txt                                                                                          
;                                                                                                                   
; This text file contains a list of function components available in the fit_function                               
; object in OSPEX.  It also describes the parameters for each component.                                            
;                                                                                                                   
; The path to this file is in the env. var. OSPEX_MODELS_DIR.                                                       
; This file is read and parsed by the routine fit_model_components.                                                 
;                                                                                                                   
; To add a new function component, edit this file as described below.  In your IDL                                  
; session, set the env. var OSPEX_MODELS_DIR to point to the directory in which you                                 
; saved the file (via a command like setenv,'OSPEX_MODELS_DIR=C:/xxx/yyy'. The required                             
; edits are to add the function component name and parameter information to this file                               
; as follows (easier to just look at examples in file):                                                             
;                                                                                                                   
;   Line 1: The short name in column 0, followed by dash, followed by short description.                            
;   Line 2: Blank, short name in column 1, dash, longer description.  If need more than one                         
;     line, indent following lines.                                                                                 
;   Lines 3-n: Indent 3, a[n) - description of parameter n                                                          
;                                                                                                                   
; You must also provide two functions, f_xxx and f_xxx_defaults as follows:                                         
;  Provide a function called f_xxx that returns the computed function with the following arguments:                 
;    x_edges - 2xn array of values for the independent variable (energy in our case)                                
;    params - array of parameters needed by the function                                                            
;    _extra=_extra - in case the function is called with keywords, this will prevent it from crashing               
;    Example: function f_vth, energy_edges, params, _extra=_extra                                                   
;  Provide a routine called f_xxx_defaults (no arguments) that returns a structure of default                       
;  values for the function in a structure like (this is for f_vth):                                                 
;    defaults = { $                                                                                                 
;     fit_comp_params: [1e0, 2], $                                                                                  
;     fit_comp_minima: [1e-20, 5e-1], $                                                                             
;     fit_comp_maxima: [1e20, 5e1], $                                                                               
;     fit_comp_free_mask: 1B+Bytarr(2)  }                                                                           
; For example, for the vth component, the function routine is called f_vth and the function                         
; to return defaults is f_vth_defaults.          
; To use this in your working directory
;	setenv,'OSPEX_MODELS_DIR='+curdir()                                                                   
;                                                                                                                   
; Written: Kim Tolbert April 2, 2003                                                                                
; Modifications:                                                                                                    
;  16-Jul-2004, Kim.  Added 3pow function                                                                           
;  04-Aug-2004, Kim.  Added ion function                                                                            
;  11-Oct-2005, Kim.  Added more info in header about how to add user functions.                                    
;  01-May-2006, Kim.  Added 3rd and 5th param for vth, and 2 multi_therm funcs to allow                             
;    rel abun to be a fitting parameter.  Added comments to not use vth_noline anymore.                             
;  27-Jun-2006, Kim.  Added drm_mod function                                                                        
;  06-Oct-2006, Kim.  Added pileup_mod function                                                                     
;  15-Oct-2006, Kim.  Added 4th parameter for pileup_mod                                                            
;  13-Oct-2007, Kim.  Added f_template and positronium functions                                                    
;  16-Jan-2008, Kim.  Changed pileup_mod params for modified pileup_countrate routine                               
;  30-Jan-2008, Kim.  Added photon_thin, photon_thick                                                               
;  14-Apr-2008, Kim.  Added URLs for thin and thick target documentation                                            
;  01-may-2008, ras,  replaced  Center Thickness Ratio with blanket_coeff in hsi_drm_mod                            
;  12-May-2008, Kim. Added f_vth_abun, and changed a[2] text for vth                                                
;  30-Jun-2008, Kim. Added 2 additional params to vth_abun, multi_therm_abun_exp, multi_therm_abun_pow              
;  12-Aug-2008, Kim. Added gain_mod                                                                                 
;  16-Jan-2009, Jana, Added thin_kappa                                                                              
;  19-May-2009, Yang Su, Added thick2                                                                               
;  22-Jun-2009, Kim,  Added thin2                                                                                   
;  17-Sep-2009, Kim.  Added 1pow, exp, 1pow_exp                                                                     
;  11-Dec-2009, Kim.  Added bpow_ep                                                                                 
;  21-Apr-2010, Kim.  Added albedo                                                                                  
;  04-Feb-2011, Kim.  Added thin_ndistr (from Jana Kasparova)                                                       
;  16-Feb-2011, Kim.  Added text for valid temperature range for thermal functions.                                 
;  08-Jun-2011, Kim.  Added thick2_vnorm and alphabetized list                                                      
;  20-Jun-2011, Kim.  Shortened parameter descriptions                                                              
;  26_Aug-2011, Kim.  Added thick2_nui (from Yang Su)                                                               
;  26-Jul-2012, Kim.  Added multi_therm_gauss (from Andrew Inglis)                                                  
;  15-Aug-2012, Kim.  Added new template options for template (from G. Share)
;  08-Feb-2013, Kim.  Added thick2_rc (from Gordon Holman)  
;  12-Aug-2013, Kim.  Added 2vth                                     
;  21-Aug-2013, Kim.  Added drm_mod2
;  10-Oct-2013, Kim.  Added 2vth_abun
;  13-Nov-2013, Kim.  Added DEM(T) equation in description of multi_therm_gauss, and changed wording
;  19-Nov-2013, Kim.  Added multi_therm_pow_exp, and modified description for other multi_therm functions
;  25-Mar-2014, Kim.  Added multi_therm_2pow 
;  02-Apr-2014, Kim.  Added thin2sm (from Qingrong Chen)
;  11-Apr-2014, Kim.  Added line_asym, line_nodrm, line_asym_nodrm, 1pow_nodrm, 3pow_nodrm, exp_nodrm
;  14-May-2014, Kim.  Added exp2 and changed exp_nodrm to exp2_nodrm
;  09-Jul-2014, Kim.  thick2_vnorm and thick2_rc ref energy is no longer fixed at 50. Changed wording for a[6]
;                     Also corrected wording for thick2_rc a[1] and a[2] parameters.
;  25-Jul-2014, Kim.  Modified description for drm_mod and drm_mod2 to include Messenger
;  02-Sep-2014, Richard Schwartz.  Added information about template normalization
;  15-Dec-2014, Kim,  Added multi_therm_linear_gauss (request from E. Kontar)
;  19-Mar-2015, Kim.  Added reference for albedo function
;  24-Jul-2015, KIm.  Added thick_warm (from E. Kontar)
;  17-Aug-2015, Kim.  Modified thick_warm to add a[9] abundance parameter
;  07-Nov-2017, Kim,  Clarified that parameters in thick functions are for electron *flux* distribution
;  30-Nov-2017, Kim. Added poly
;  13-Feb-2018, Kim. The nodrm and asym functions did not show the correct comp name on the seconds line (e.g. 1pow_nodrm
;                    had just 1pow on second longer description line)
;  10-Apr-2018, Kim. Added thick_warm_kappa (from E. Kontar)
;  14-Feb-2019, Kim. Added thick2_vnorm_exp
;  22-Feb-2019, Kim. Added scat_22 template option to template
;                                                                                                                   
;--------------------------------------------------------------------------------                                   
                                                                                                                    
1pow - Single Power Law                                                                                             
 1pow - Single power-law function with epivot control                                                               
 epivot parameter allows user to set epivot easily, but it should not be a free parameter in fitting                
   a[0] - normalization at epivot                                                                                   
   a[1] - negative power-law index                                                                                  
   a[2] - epivot (keV)                                                                                              
                                                                                                                    
1pow_nodrm	- Single Power Law, does not go through DRM
 1pow_nodrm - Single power-law function with epivot control, does not go through DRM
 epivot parameter allows user to set epivot easily, but it should not be a free parameter in fitting
   a[0] - normalization at epivot                
   a[1] - negative power-law index
   a[2] - epivot (keV)
   
1pow_exp - Single Power Law Times an Exponential                                                                    
 1pow_exp - Single Power Law Times an Exponential                                                                   
   a[0] - normalization at epivot for power-law                                                                     
   a[1] - negative power-law index                                                                                  
   a[2] - epivot (keV) for power-law                                                                                
   a[3] - Normalization for exponential                                                                             
   a[4] - Pseudo temperature for exponential                                                                        
                                                                                                                    
3pow - Triple Power Law                                                                                             
 3pow - Triple broken power-law function with/without discontinuities in the derivatives                            
   a[0] - normalization at epivot, photon flux of first power-law at epivot                                         
   a[1] - negative power law index below break energy1                                                              
   a[2] - break energy1 (keV)                                                                                       
   a[3] - negative power law index between break energy1 and break energy2                                          
   a[4] - break energy2 (keV)                                                                                       
   a[5] - negative power law index above break energy2                                                              

3pow_nodrm - Triple Power Law, does not go through DRM                                    
 3pow_nodrm - Triple broken power-law function with/without discontinuities in the derivatives, does not go through DRM
   a[0] - normalization at epivot, photon flux of first power-law at epivot                                         
   a[1] - negative power law index below break energy1                                                              
   a[2] - break energy1 (keV)                                                                                       
   a[3] - negative power law index between break energy1 and break energy2                                          
   a[4] - break energy2 (keV)                                                                                       
   a[5] - negative power law index above break energy2 
   
albedo - Pseudo function for correcting for albedo                                                                  
 albedo - always returns a value of 0. Parameters are varied during fit and used                                    
  in apply_drm method to correct photon model for albedo on the fly.  Source position                               
  used can be viewed/changed by getting/setting the parameter spex_source_xy. 
  (see Kontar et al, 2006, 2006A&A...446.1157K)
   a[0] - anisotropy.  Ratio of up to down flux, 1.0=isotropic                                                      
                                                                                                                    
bpow - Broken Power Law                                                                                             
 bpow - Broken power-law function                                                                                   
   a[0] - normalization at epivot                                                                                   
   a[1] - negative power law index below break                                                                      
   a[2] - break energy (keV)                                                                                        
   a[3] - negative power law index above break                                                                      
                                                                                                                    
bpow_ep - Broken Power Law with epivot control                                                                      
 bpow_ep - Broken power-law function with epivot control                                                            
 epivot parameter allows user to set epivot easily, but it should not be a free parameter in fitting                
   a[0] - normalization at epivot                                                                                   
   a[1] - negative power law index below break                                                                      
   a[2] - break energy (keV)                                                                                        
   a[3] - negative power law index above break                                                                      
   a[4] - epivot (keV)                                                                                              
                                                                                                                    
drm_mod - Pseudo function for fine-tuning RHESSI or Messenger DRM parameters                                                     
 drm_mod - always returns a value of 0.  Parameters are varied during fit and used                                  
  in apply_drm method to compute drm on the fly.                                                                    
   a[0] - FWHM fraction of default                                                                                          
   a[1] - Gain offset (keV)                                                                                          
   a[2] - Blanket Coefficient - default is 1, multiplies cross section (RHESSI), or Gain (Messenger)                                   

drm_mod2 - Pseudo function for fine-tuning RHESSI or Messenger DRM parameters, same as drm_mod, but more parameters
 drm_mod2 - always returns a value of 0.  Parameters are varied during fit and used                                  
  in apply_drm method to compute drm on the fly.                                                                    
   a[0] - FWHM fraction of default                                                                                          
   a[1] - Gain offset (keV)                                                                                          
   a[2] - Blanket Coefficient - default is 1, multiplies cross section (RHESSI), or Gain (Messenger)  
   a[3] - Center thickness ratio - ratio of thickness of thinnest region on attenuator to nominal (RHESSI)
   a[4] - dummy place holder
   a[5] - dummy place holder
   a[6] - dummy place holder
   
exp - Exponential                                                                                                   
 exp - Exponential                                                                                                  
   a[0] - Normalization                                                                                             
   a[1] - Pseudo temperature 

exp2 - Exponential with log normalization                                                                                                  
 exp2 - Exponential                                                                                                  
   a[0] - 0 /1 Function is on or off
   a[1] - Log of Normalization                                                                                             
   a[2] - Pseudo temperature
   
exp2_nodrm - Exponential with log normalization, does not go through DRM     
 exp_nodrm - Exponential, does not go through DRM
   a[0] - 0 /1 Function is on or off
   a[1] - Log of Normalization                                                                                             
   a[2] - Pseudo temperature   
                                                                                                                    
gain_mod - Pseudo function for modifying energy bins in model                                                       
 gain_mod - always returns a value of 0.  Parameters are varied during fit and used                                 
  in apply_drm method to modify energy bins for model on the fly.                                                   
  New edges are (1+a[0])*old_edges + a[1]                                                                           
   a[0] - Gain delta                                                                                                
   a[1] - Offset in energy units (usually keV) at 0.0                                                               
                                                                                                                    
ion - Non-uniform Target Ionization Spectrum                                                                        
 ion - Non-uniform Target Ionization Spectrum                                                                       
   a[0] - photon normalization                                                                                      
   a[1] - spectral index of electron flux                                                                           
   a[2] - break energy (keV)                                                                                        
                                                                                                                    
line - Gaussian                                                                                                     
 line - Single Gaussian function (high quality), width in sigma                                                     
   a[0] - integrated intensity                                                                                      
   a[1] - centroid                                                                                                  
   a[2] - sigma
   
line_nodrm - Gaussian, does not go through DRM
 line_nodrm - Single Gaussian function (high quality), width in sigma, does not go through DRM
   a[0] - integrated intensity                                                                                      
   a[1] - centroid                                                                                                  
   a[2] - sigma 
   
line_asym - Asymmetric Gaussian                                                                                                     
 line_asym - Single Asymmetric Gaussian function (high quality), width in sigma                                                     
   a[0] - integrated intensity                                                                                      
   a[1] - centroid                                                                                                  
   a[2] - sigma for energies < a[1]
   a[3] - sigma for energies > a[1]
     
line_asym_nodrm - Asymmetric Gaussian, does not go through DRM               
 line_asym_nodrm - Single Asymmetric Gaussian function (high quality), width in sigma, does not go through DRM
   a[0] - integrated intensity                                                                                      
   a[1] - centroid                                                                                                  
   a[2] - sigma for energies < a[1]
   a[3] - sigma for energies > a[1]
   
multi_therm_abun_exp - Multithermal, Exp Temp, Separate Abundances                                                  
 multi_therm_abun_exp - Multithermal function with the differential emission measure (DEM) having a Exponential dependency on the temperature (T) (separate abun) 
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - DEM at T=2 keV in units of 10^49 cm^(-3) keV^(-1)                                         
   a[1] - Minimum temperature (Tmin in keV) used for the integration                                                                          
   a[2] - Maximum temperature (Tmax in keV) used for the integration                                                                          
   a[3] - Temperature scale length (keV) for calculating the DEM at temp. T:                          
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
          DEM(T) = a[0] * exp( (2. - T) / a[3] )                                                                    
   a[4] - Relative abundance for Iron and Nickel                                                                    
   a[5] - Relative abundance for Calcium                                                                            
   a[6] - Relative abundance for Sulfur                                                                             
   a[7] - Relative abundance for Silicon                                                                            
   a[8] - Relative abundance for Argon                                                                              
   a[9] - Relative abundance for He, C, N, O, F, Ne, Na, Mg, Al, K                                                  
          Relative to coronal abundance for Chianti                                                                 
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            
                                                                                                                    
multi_therm_abun_pow - Multithermal, Pow Temp, Separate Abundances                                                  
 multi_therm_abun_pow - Multithermal function with the differential emission measure (DEM) having a Power Law dependency on the temperature (T) (separate abun)    
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - DEM at T=2 keV in units of 10^49 cm^(-3) keV^(-1)                                          
   a[1] - Minimum temperature (Tmin in keV) used for the integration                                                                         
   a[2] - Maximum temperature (Tmax in keV) used for the integration                                                                          
   a[3] - Power-law index for calculating the DEM at temperature T:                                   
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
          DEM(T) = a[0] * (2./T)^a[3]                                                                               
   a[4] - Relative abundance for Iron and Nickel                                                                    
   a[5] - Relative abundance for Calcium                                                                            
   a[6] - Relative abundance for Sulfur                                                                             
   a[7] - Relative abundance for Silicon                                                                            
   a[8] - Relative abundance for Argon                                                                              
   a[9] - Relative abundance for He, C, N, O, F, Ne, Na, Mg, Al, K                                                  
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            
                                                                                                                    
multi_therm_exp - Multithermal, Exp Temp                                                                            
 multi_therm_exp - Multithermal function with the differential emission measure (DEM) having a Exponential dependency on the temperature (T).      
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - DEM at T=2 keV in units of 10^49 cm^(-3) keV^(-1)                                          
   a[1] - Minimum temperature (Tmin in keV) used for the integration                                                                          
   a[2] - Maximum temperature (Tmax in keV) used for the integration                                                                          
   a[3] - Temperature scale length (keV) for calculating the DEM at temp T: 
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1   
          DEM(T) = a[0] * exp( (2. - T) / a[3] )                                                                    
   a[4] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            
                                                                                                                    
multi_therm_gauss - Multithermal, Gaussian DEM distribution                                                         
 multi_therm_gauss - Multithermal function with the differential emission measure (DEM) having a Gaussian dependency on the logarithm of the temperature (T).       
 Valid integration range is for log T(K) between 6.0 and 8.0 (T between 10^6 and 10^8 K or 0.086 to 8.6 keV)
  a[0] - Peak emission measure of the Gaussian DEM in units of 10^49 cm^-3 keV^-1                 
  a[1] - Minimum temperature (Tmin in keV) used for the integration                                                 
  a[2] - Maximum temperature (Tmax in keV) used for the integration                                                 
  a[3] - Standard deviation of the Gaussian DEM in log T (K or keV, units of T don't matter)                                           
  a[4] - Peak temperature (Tpeak in keV) of the Gaussian DEM (.086 < Tpeak < 8.6 keV)
         DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
         DEM(T) = a[0] * exp( -(alog10(a[4]) - alog10(T))^2 / (2.*a[3]^2) )
  a[5] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                               
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
		  
multi_therm_linear_gauss - Multithermal, Gaussian in linear T DEM distribution                                                         
 multi_therm_linear_gauss - Multithermal function with the differential emission measure (DEM) having a Gaussian dependency on the temperature (T).       
 Valid integration range is for log T(K) between 6.0 and 8.0 (T between 10^6 and 10^8 K or 0.086 to 8.6 keV)
  a[0] - Peak emission measure of the Gaussian DEM in units of 10^49 cm^-3 keV^-1                 
  a[1] - Minimum temperature (Tmin in keV) used for the integration                                                 
  a[2] - Maximum temperature (Tmax in keV) used for the integration                                                 
  a[3] - Standard deviation of the Gaussian DEM in log T (K or keV, units of T don't matter)                                           
  a[4] - Peak temperature (Tpeak in keV) of the Gaussian DEM (.086 < Tpeak < 8.6 keV)
         DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
		 DEM(T) = a[0] * exp( -(T - a[4])^2 / (2*a[3]^2) ) / (sqrt(2*!pi)*a[3])
  a[5] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                               
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                

multi_therm_pow - Multithermal, Pow Temp                                                                            
 multi_therm_pow - Multithermal function with the differential emission measure (DEM) having a Power Law dependency on the temperature (T).
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - DEM at T=2 keV in units of 10^49 cm^(-3) keV^(-1)                                          
   a[1] - Minimum temperature (Tmin in keV) used for the integration                                                                          
   a[2] - Maximum temperature (Tmax in keV) used for the integration                                                                          
   a[3] - Power-law index for calculating the DEM at temperature T:                                         
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
          DEM(T) = a[0] * (2./T)^a[3]
   a[4] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            
   
multi_therm_pow_exp - Multithermal, Pow Temp * Exp Temp                                                                            
 multi_therm_pow_exp - Multithermal function with the differential emission measure (DEM) having a Power Law * Exponential dependency on the temperature (T).               
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - Total emission measure integrated over all temperatures in units of 10^49 cm^-3                                           
   a[1] - Minimum temperature (Tmin in keV) used for the integration (Recommendation: don't change this)                                                                         
   a[2] - Maximum temperature (Tmax in keV) used for the integration (Recommendation: don't change this)                                                                         
   a[3] - Power-law index for calculating the DEM at temperature T
   a[4] - Peak temperature (keV) of the DEM    
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
          DEM(T): a[0] * (a[3]*a[4]/T)^a[3] * exp(-a[3]*a[4]/T) / (a[3]*a[4]*gamma(a[3]-1))
          gamma(t): integral from 0 to infinity of (x^(t-1) * exp(-x) * dx)
   a[5] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe   

multi_therm_2pow - TEST VERSION, DO NOT USE YET UNLESS YOUR NAME IS EDUARD!  Multithermal, Two Pow Temp                                                                           
 multi_therm_2pow - Multithermal function with the differential emission measure (DEM) having a Two Power Law dependency on the temperature (T).               
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - Total emission measure integrated over all temperatures divided by BETA(alpha+1/beta-alpha-1) in units of 10^49 cm^-3                                           
   a[1] - Minimum temperature (Tmin in keV) used for the integration (Recommendation: don't change this)                                                                         
   a[2] - Maximum temperature (Tmax in keV) used for the integration (Recommendation: don't change this)                                                                         
   a[3] - Alpha, First Power-law index for calculating the DEM at temperature T
   a[4] - Beta, Second Power-law index for calculating the DEM at temperature T
   a[5] - T0 in keV, Peak temperature of the DEM  = T0 * alpha / (beta-alpha)
          DEM(T): Differential emission measure at temperature T(keV) in units of 10^49 cm^-3 keV^-1
		  DEM(T): a[0] * ( (T/T0)^alpha * (1. + T/T0)^(-beta) ) / T0
		  DEM(T): a[0] * ( (T/a[5])^a[3] * (1. + T/a[5])^(-a[4]) ) / a[5]
   a[6] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe   
   
photon_thick - Thick target photon spectrum using Bethe-Heitler cross-section.                                      
 photon-thick - Similar to "thick" function but ~10x faster. No integration                                         
    over electron spectrum - photon spectrum is an analytical function of                                           
    electron distribution parameters.  Good approximation < low-energy cutoff,                                      
    ~10% difference from "thick" for energies >~100 keV.                                                            
   a[0] - total electron flux (1.e35 electrons/s)                                                                   
   a[1] - spectral index below break energy                                                                         
   a[2] - break energy (keV)                                                                                        
   a[3] - spectral index above break energy                                                                         
   a[4] - low-energy cutoff (keV)                                                                                   
   a[5] - high-energy cutoff (keV)                                                                                  
                                                                                                                    
photon_thin - Thin target photon spectrum using Bethe-Heitler cross-section.                                        
 photon_thin - Similar to "thin" function but ~2x faster. No integration                                            
    over electron spectrum - photon spectrum is an analytical function of                                           
    electron distribution parameters.  Good approximation < low-energy cutoff,                                      
    ~10% difference from "thick" for energies >~100 keV.                                                            
   a[0] - total electron flux (in 1d55 electrons/s/cm^2)                                                            
   a[1] - spectral index below break energy                                                                         
   a[2] - break energy (keV)                                                                                        
   a[3] - spectral index above break energy                                                                         
   a[4] - low-energy cutoff (keV)                                                                                   
   a[5] - high-energy cutoff (keV)                                                                                  
                                                                                                                    
pileup_mod - Pseudo function for correcting for pileup (Experts only)                                               
 pileup_mod - always returns a value of 0. Parameters are varied during fit and used                                
  in apply_drm method to add pileup effects to model on the fly.                                                    
   a[0] - coefficient to increase or decrease probability of pileup for energies > cutoff                           
   a[1] - average fractional energy from piled up photon                                                            
   a[2] - smoothing parameter in keV (sigma)                                                                        
   a[3] - cutoff energy (keV) that defines two regions                                                              
   a[4] - effectiveness ratio for pileup for energy loss less than cutoff energy                                    
   a[5] - sine-modulated fraction of flux

poly - Polynomial function
 poly -   Polynomial function with offset in x   
   a[0] - 0th order coefficient
   a[1] - 1st order coefficient
   a[2] - 2nd order coefficient
   a[3] - 3rd order coefficient
   a[4] - 4th order coefficient
   a[5] - x offset, such that function value at x=a[5] is a[0]
                                                                                                                    
positronium - Positronium + 511                                                                                     
 positronium - Positronium continuum with 511 keV line                                                              
   a[0] - Annihilation line flux                                                                                    
   a[1] - Positronium continuum flux                                                                                
   a[2] - Annihilation line sigma                                                                                   
   a[3] - Annihilation line centroid                                                                                
                                                                                                                    
template - Template function                                                                                        
 template - Interpolates a template-defined function of energy into user's energy bins                              
   a[0] - Normalization in photon /cm2 /sec at Earth over the full energy range of the template                     
   Keyword options: brd_nuc, nar_nuc, brd+nar_nuc, pion_s30, pion_s35, pion_s40, pion_s45, pion_s50,                
                    scat_22, nuc1, nuc2, vern, alpha, fline, bline, nline                                                    
     brd_nuc - includes the broad nuclear de-excitation lines produced by nuclei heavier than helium having         
            a differential power-law index of 4.0.                                                                  
            Does not include the 511 keV and 2.2 MeV lines.  Assume downward isotropic distribution of              
            accelerated particles, a coronal abundance of accelerated particles, coronal ambient                    
            abundance(He/H = 0.1), and a heliocentric angle of 60 degrees.
            Corresponds to 6.573e30 protons gt 30 MeV at the Sun.
     nar_nuc - includes the narrow nuclear de-excitation lines produced by                                          
            proton and alpha particles having a differential power-law index of 4.0.                                
            Does not include the 511 keV, 2.2 MeV lines, and the alpha-helium lines.  Assume downward               
            isotropic distribution of accelerated particles, a coronal abundance of accelerated particles with      
            alpha/proton = 0.22, coronal ambient abundance (He/H = 0.1), and a heliocentric angle of 60 degrees. 
            Corresponds to 8.59e29 protons gt 30 MeV at the Sun.
     brd_nar_nuc - Combined spectrum of brd_nuc and nar_nuc using the broad to narrow ratio found in SMM flares  
            Corresponds to 7.60e29 protons gt 30 MeV at the Sun.
	 pion_s30 - pion decay produced by accelerated protons with spectral index of 3.0. Assume isotropic             
            distribution of accelerated particles, alpha/proton = .10,                                              
            magnetic field of 300 gauss, and hydrogen density of 1.e15. 
            Corresponds to 1.88e30 protons gt 30 MeV at the Sun.
     pion_s35 - pion decay produced by accelerated protons with spectral index of 3.5. Assume isotropic             
            distribution of accelerated particles, alpha/proton = .10,                                              
            magnetic field of 300 gauss, and hydrogen density of 1.e15. 
            Corresponds to 9.96e30 protons gt 30 MeV at the Sun.
     pion_s40 - pion decay produced by accelerated protons with spectral index of 4.0. Assume isotropic             
            distribution of accelerated particles, alpha/proton = .10,                                              
            magnetic field of 300 gauss, and hydrogen density of 1.e15. 
            Corresponds to 4.90e31 protons gt 30 MeV at the Sun.
     pion_s45 - pion decay produced by accelerated protons with spectral index of 4.5. Assume isotropic             
            distribution of accelerated particles, alpha/proton = .10,                                              
            magnetic field of 300 gauss, and hydrogen density of 1.e15. 
            Corresponds to 2.30e32 protons gt 30 MeV at the Sun.
     pion_s50 - pion decay produced by accelerated protons with spectral index of 5.0. Assume isotropic             
            distribution of accelerated particles, alpha/proton = .10,                                              
            magnetic field of 300 gauss, and hydrogen density of 1.e15. 
            Corresponds to 1.04e33 protons gt 30 MeV at the Sun.
     scat_22  - Compton scattered radiation from the solar neutron capure line at 2.2 MeV, calculated
            at heliocentric angle of 30 degrees (but can be used at other angles)
     nuc1 - includes the broad nuclear de-excitation lines produced by                                              
            proton, alpha, and heavier nuclei, does not include the 511 keV and 2.2                                 
            MeV lines. Note: this is out-of-date. Use brd_nuc instead.                                              
     nuc2 - includes the narrow nuclear de-excitation lines produced by                                             
            proton, alpha, and heavier nuclei, does not include the 511 keV and 2.2                                 
            MeV lines. Note: this is out-of-date. Use nar_nuc instead.	                                             
     vern - includes the calculated shape of the 511 keV annihilation line and                                      
            its positronium continuum produced in the conditions of a solar atmosphere                              
            calculated by Vernazza et al for a temperature of 5000 K.			                                            
     alpha - includes the line feature produced by alpha-alpha collisions for a                                     
            downward isotropic distribution of accelerated particles with a power                                   
            spectrum with index 3.5 for a flare at 60 heliocentric angle. Note that                                 
            nuc1, nuc2, and vern contain this line so it is best not to                                             
            use both of these specific templates at the same time			                                                
     fline - includes broad and narrow nuclear lines. Note: out-of-date. Use brd_nar_nuc instead.                   
     bline - includes broad nuclear lines.  Note: out-of-date. Use brd_nuc instead.                                 
     nline - includes narrow nuclear lines.  Note: out-of-date. Use nar_nuc instead.                                
     user -  user-supplied template in user_template.sav or user_template.txt file                                  
			                                                                                                                 
thick - Thick Target Bremsstrahlung                                                                                 
 thick - Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution               
         (see http://hesperia.gsfc.nasa.gov/ssw/packages/xray/doc/brm_thick_doc.pdf)                                
   a[0] - Total integrated electron flux, in units of 10^35 electrons sec^(-1)                                      
   a[1] - power-law index of the electron flux distribution function below eebrk                                         
   a[2] - break energy in the electron flux distribution function (keV)                                                  
   a[3] - power-law index of the electron flux distribution function above eebrk                                         
   a[4] - low energy cutoff in the electron flux distribution function (keV)                                             
   a[5] - high energy cutoff in the electron flux distribution function (keV)                                            
                                                                                                                    
thick_nui - NonUniform Ionization (NUI) Thick Target, with two ionization profiles                                  
 thick_nui - Nonthermal bremsstrahlung X-ray spectrum from a thick target with step-function or                     
 linear-function ionization profiles. Relativistic energy loss and full cross section are included.                 
 Based on Thick2.                                                                                                   
   a[0] - Total integrated electron flux, 10^35 electrons sec^(-1)                                                  
   a[1] - Power-law index of the electron flux distribution function                                                     
   a[2] - Stopping energy E* or E1 (keV); 0 for fully ionized thick target                                          
   a[3] - Difference between E1 and E0 (E0-E1) (keV); 0 for step-function                                           
   a[4] - Low energy cutoff (keV); fixed to 1 or 3 keV for RHESSI; (KEEP FIXED NORMALLY)                            
   a[5] - High energy cutoff (keV)                                                                                  

thick_warm - Warm Thick Target Bremsstrahlung                                                                    
 thick_warm - Warm Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution              
               Based on thick2 and vth             
   a[0] - Total integrated electron flux, 10^35 electrons sec^(-1)                                                  
   a[1] - Low delta, index of electron flux distribution function below break                                            
   a[2] - Break energy (keV). For single power-law electron distr., set GE high E cutoff or LE low E cutoff         
   a[3] - High delta, index of electron flux distr. function above break                                                 
   a[4] - low energy cutoff (keV)                                                                                   
   a[5] - high energy cutoff (keV)
   a[6] - Warm plasma density (10^10 cm ^-3)
   a[7] - Warm plasma temperature (keV) 
   a[8] - Warm plasma length (Mm), 1Mm = 10^8 cm
   a[9] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti

thick_warm_kappa - Warm Thick Target Bremsstrahlung for electron kappa distribution
 thick_warm_kappa - Warm Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from a kappa distribution of electrons
               Based on thick_warm and thin_kappa             
   a[0] - Total integrated electron flux, 10^35 electrons sec^(-1)                                                  
   a[1] - Low delta, index of electron flux distribution function below break                                            
   a[2] - Kappa temperature (keV).                                                                                          
   a[3] - High energy cutoff in electron flux distribution function (keV)
   a[4] - Warm plasma density (10^10 cm ^-3)
   a[5] - Warm plasma temperature (keV) 
   a[6] - Warm plasma length (Mm), 1Mm = 10^8 cm
   a[7] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti
		  
thick2 - Thick Target Bremsstrahlung Version 2                                                                      
 thick2 - Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution              
          Version 2 (~10-100 times faster than Version 1, with a relative error of ~1.e-4)                          
          (see http://hesperia.gsfc.nasa.gov/ssw/packages/xray/doc/brm_thick_doc.pdf)                               
   a[0] - Total integrated electron flux, 10^35 electrons sec^(-1)                                                  
   a[1] - Low delta, index of electron flux distribution function below break                                            
   a[2] - Break energy (keV). For single power-law electron distr., set GE high E cutoff or LE low E cutoff         
   a[3] - High delta, index of electron flux distr. function above break                                                 
   a[4] - low energy cutoff (keV)                                                                                   
   a[5] - high energy cutoff (keV)

thick2_rc - Thick Target Bremsstrahlung Version 2 with independent normalization and return-current losses                            
 thick2_rc - Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution        
                          
   a[0] - Electron flux at ref energy a[6], 10^35 electrons (sec keV)^(-1)                                          
   a[1] - Delta, power-law index of injected electron distr. function
   a[2] - Total potential drop (kV) from electron injection point to thick target         
   a[3] - Not used                                                 
   a[4] - low energy cutoff (keV)                                                                                   
   a[5] - high energy cutoff (keV)                                                                                  
   a[6] - Reference energy (keV) at which function is normalized (KEEP FIXED DURING FIT) 
                                                                                                                    
thick2_vnorm - Thick Target Bremsstrahlung Version 2 with independent normalization                                 
 thick2_vnorm - Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution        
          Like Thick2, except a[0] is not highly coupled with a[4], and extra param a[6]                            
   a[0] - Electron flux at ref energy a[6], 10^35 electrons (sec keV)^(-1)                                          
   a[1] - Low delta, index of electron flux distr. function below break                                                  
   a[2] - Break energy (keV). For single power-law electron distr., set GE high E cutoff or LE low E cutoff         
   a[3] - High delta, index of electron flux distr. function above break                                                 
   a[4] - Low energy cutoff (keV)                                                                                   
   a[5] - High energy cutoff (keV)                                                                                  
   a[6] - Reference energy (keV) at which function is normalized (KEEP FIXED DURING FIT) 

thick2_vnorm_exp - Thick Target Bremsstrahlung Version 2 with independent norm and exponential modifying thick-target powerlaw distribution
 thick2_vnorm_exp - Thick-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron distribution        
          Like Thick2_vnorm, except a[5] is rolloff energy at which exponential modifies thick-target powerlaw distribution. High energy cutoff
          is set to 6.0 times this value. Result approaches thick2_vnorm values below a[5] keV.		  
   a[0] - Electron flux at ref energy a[6], 10^35 electrons (sec keV)^(-1)                                          
   a[1] - Low delta, index of electron flux distr. function below break                                                  
   a[2] - Break energy (keV). For single power-law electron distr., set GE high E cutoff or LE low E cutoff         
   a[3] - High delta, index of electron flux distr. function above break                                                 
   a[4] - Low energy cutoff (keV)                                                                                   
   a[5] - Exponential high energy cutoff (keV). Electron distribution multiplied by exp( -E/a[5] ).
   a[6] - Reference energy (keV) at which function is normalized (KEEP FIXED DURING FIT)    

thin - Thin Target Bremsstrahlung                                                                                   
 thin - Thin-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron flux density distribution    
        (electrons cm^(-2) sec^(-1) keV^(-1))                                                                       
        (see http://hesperia.gsfc.nasa.gov/ssw/packages/xray/doc/brm_thin_doc.pdf)                                  
   a[0] - normalization factor in 1.0d55 electrons cm^(-2) sec^(-1),                                                
          i.e. plasma density * volume of source * integrated nonthermal electron flux density                      
   a[1] - power-law index of the electron flux density distribution function below eebrk                            
   a[2] - break energy in the electron flux density distribution function (keV)                                     
   a[3] - power-law index of the electron flux density distribution function above eebrk                            
   a[4] - low energy cutoff in the electron flux density distribution function (keV)                                
   a[5] - high energy cutoff in the electron flux density distribution function (keV)                               
                                                                                                                    
thin2 - Thin Target Bremsstrahlung Version 2                                                                        
 thin2 - Thin-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron flux density distribution   
         (electrons cm^(-2) sec^(-1) keV^(-1))                                                                      
         Version 2 (2-10 times faster than Version 1)                                                               
        (see http://hesperia.gsfc.nasa.gov/ssw/packages/xray/doc/brm_thin_doc.pdf)                                  
   a[0] - normalization factor in 10^55 electrons cm^(-2) sec^(-1),                                                 
          i.e. plasma density * volume of source * integrated nonthermal electron flux density                      
   a[1] - power-law index of the electron flux density distribution function below eebrk                            
   a[2] - break energy in the electron flux density distribution function (keV)                                     
   a[3] - power-law index of the electron flux density distribution function above eebrk                            
   a[4] - low energy cutoff in the electron flux density distribution function (keV)                                
   a[5] - high energy cutoff in the electron flux density distribution function (keV)                               

thin2sm - Thin Target Bremsstrahlung Version 2 for a Smoothly Broken Power-Law
 thin2sm - Thin-Target Bremsstrahlung x-ray/gamma-ray spectrum from an isotropic electron flux distribution,
           X(E) = nVF(E) = a[0]*brm2sm_distrn(...), in units of 1d55 electrons cm^(-2) sec^(-1) keV^(-1)
   a[0] - normalization factor in 1.0d55 electrons cm^(-2) sec^(-1) keV^(-1),
             i.e. plasma density * volume of source * nonthermal electron flux at Eno=100 keV
             such that normalization for X(Eno) = a(0) *1d55 cm-2 sec-1 keV-1; but not the integration
   a[1] - power-law index of the electron number density distribution function below eebrk
   a[2] - break energy in the electron number density distribution function (keV)
   a[3] - power-law index of the electron number density distribution function above eebrk
   a[4] - low energy cutoff in the electron number density distribution function (keV)
   a[5] - high energy cutoff in the electron number density distribution function (keV)
   a[6] - width of transition between the two power-laws (keV) ;;new parameter
   
thin_kappa - thin-target bremsstrahlung spectrum for electron kappa distribution                                    
 thin_kappa - thin target spectrum for electron kappa distribution                                                  
   a[0] - "emission measure" (10^49 cm^-3, i.e. ambient proton density*volume*electron density in kappa distr. )    
   a[1] - temperature (keV)                                                                                         
   a[2] - kappa index                                                                                               
   a[3] - high-energy cutoff (keV)                                                                                  
                                                                                                                    
thin_ndistr - thin-target bremsstrahlung spectrum for electron n-distribution                                       
 thin_ndistr - thin target spectrum for electron n-distribution                                                     
   a[0] - "emission measure" (10^49 cm^-3, i.e. ambient proton density*volume*electron density in n-distr.)         
   a[1] - pseudo-temperature (keV)                                                                                  
   a[2] - n-index                                                                                                   
   a[3] - high-energy cutoff (keV)                                                                                  
                                                                                                                    
vth - Variable Thermal                                                                                              
 vth - Optically thin thermal bremsstrahlung radiation function                                                     
 as differential spectrum seen at Earth in units of photon/(cm2 s keV)                                              
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - Emission measure, 10^49 cm^(-3)                                                                           
   a[1] - KT, plasma temperature (keV)                                                                              
   a[2] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            

2vth - Sum of two Variable Thermals                          
 2vth - Two optically thin thermal bremsstrahlung radiation functions                                                     
 as differential spectrum seen at Earth in units of photon/(cm2 s keV)                                              
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - First Emission measure, 10^49 cm^(-3)                                                                           
   a[1] - First KT, plasma temperature (keV)                                                                              
   a[2] - Second Emission measure, 10^49 cm^(-3)                                                                           
   a[3] - Second KT, plasma temperature (keV)   
   a[4] - Relative abundance for Iron/Nickel, Calcium, Sulfur, Silicon                                              
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe  
   
vth_abun - Variable Thermal, Separate Abundances                                                                    
  vth_abun - Optically thin thermal bremsstrahlung radiation function                                               
  as differential spectrum seen at Earth in units of photon/(cm2 s keV)                                             
  with separate parameters for relative abundance for Fe/Ni, Ca, S, Si                                              
  Valid for temperatures between .086 and 8.6 keV.                                                                  
   a[0] - Emission measure, 10^49 cm^(-3)                                                                           
   a[1] - KT, plasma temperature (keV)                                                                              
   a[2] - Relative abundance for Iron and Nickel                                                                    
   a[3] - Relative abundance for Calcium                                                                            
   a[4] - Relative abundance for Sulfur                                                                             
   a[5] - Relative abundance for Silicon                                                                            
   a[6] - Relative abundance for Argon                                                                              
   a[7] - Relative abundance for He, C, N, O, F, Ne, Na, Mg, Al, K                                                  
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe                                                            

2vth_abun - Sum of two Variable Thermals, Separate Abundances                         
 2vth_abun - Two optically thin thermal bremsstrahlung radiation functions                                                     
 as differential spectrum seen at Earth in units of photon/(cm2 s keV)                                              
 with separate parameters for relative abundance for Fe/Ni, Ca, S, Si
 Valid for temperatures between .086 and 8.6 keV.                                                                   
   a[0] - First Emission measure, 10^49 cm^(-3)                                                                           
   a[1] - First KT, plasma temperature (keV)                                                                              
   a[2] - Second Emission measure, 10^49 cm^(-3)                                                                           
   a[3] - Second KT, plasma temperature (keV)
   a[4] - Relative abundance for Iron and Nickel     
   a[5] - Relative abundance for Calcium                                                                            
   a[6] - Relative abundance for Sulfur                                                                             
   a[7] - Relative abundance for Silicon                                                                            
   a[8] - Relative abundance for Argon                                                                              
   a[9] - Relative abundance for He, C, N, O, F, Ne, Na, Mg, Al, K                                                
          Relative to coronal abundance for Chianti                                                                 
          Relative to solar abundance for Mewe                                                                      
          (unless user selects a different abundance table manually)                                                
   Keyword options: full/continuum/lines    Chianti/Mewe  
   
vth_noline - Variable Thermal No Lines (DO NOT USE, use vth with /contin option)                                    
 vth_noline - This function is included only for compatibility with existing Fit Results files.                     
  As of May 5, 2006, please use the vth function with the continuum option for new work.                            
  Variable thermal continuum, no lines, as differential spectrum seen at                                            
  Earth in units of photon/(cm2 s keV)                                                                              
   a[0] - Emission measure, 10^49 cm^(-3)                                                                           
   a[1] - KT, plasma temperature (keV)                                                                              

stx_line_nodrm - Gaussian line with tailing 
 stx_line_nodrm - Gaussian line with tailing configured for cdte on STIX does not go through drm
   a[0] - Normalization
   a[1] - line center energy in default units, normally keV
   a[2] - gaussian line width before tailing in sigma
   a[3] - mfp_divisor, default is 1. Increase mfp_divisor to increase trapping and reduce mean free path
   a[4] - known line energy. Used to computer tailing. may be different from a[1], set to 0 to use a[1]
   a[5] - mean free path for holes in cm, for default of  0.36 set to 0,
   a[6] - mean free path for electrons in cm, for default of 24 set to 0
                                                                                                                    
                                                                                                                    
                                                                                                                    
